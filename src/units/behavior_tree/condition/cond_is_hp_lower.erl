%%%-------------------------------------------------------------------
%%% @author GZ1417
%%% @copyright (C) 2022, 4399
%%% @doc
%%% 角色血量过低
%%% @end
%%%-------------------------------------------------------------------
-module(cond_is_hp_lower).

%%--------------------------------------------------------------------
%% include
%%--------------------------------------------------------------------
-include("behavior3.hrl").
%%--------------------------------------------------------------------
%% export API
%%--------------------------------------------------------------------
-export([tick/3]).

%%--------------------------------------------------------------------
%% API functions
%%--------------------------------------------------------------------
-spec tick(tree_node(), blackboard(), term()) -> {bt_status(), blackboard(), term()}.
tick(#tree_node{properties = #{threshold := Threshold}}, BB, #{attr := #{max_hp := MaxHP, hp := HP}} = State)
    when HP * 100 div MaxHP < Threshold ->
    {?BT_SUCCESS, BB, State};
tick(_TreeNode, BB, State) ->
    {?BT_FAILURE, BB, State}.

%%--------------------------------------------------------------------
%% Internal functions
%%--------------------------------------------------------------------